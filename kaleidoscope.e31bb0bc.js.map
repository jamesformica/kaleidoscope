{"version":3,"sources":["index.js"],"names":["rad","deg","Math","PI","random","min","max","floor","RADIUS","SLICE_ANGLE","SLICE_OPPOSITE_ANGLE","SLICE_HEIGHT","sin","patternCanvas","document","getElementById","patternCtx","getContext","width","height","invPatternCanvas","invPatternCtx","kCanvas","kCtx","drawWedge","x","y","img","save","beginPath","moveTo","circlStart","circleStop","arc","clip","drawImage","restore","drawInverseWedge","translate","scale","drawWheel","i","rotate","clearCanvases","clearRect","selectPoint","imgWidth","imgHeight","top","left","right","bottom","kaleidoscopeGo","point","loop","distanceX","distanceY","length","sqrt","round","window","requestAnimationFrame","selectImage","e","Image","onload","src","target","options","getElementsByClassName","onclick","speed","handleFiles","runState","file","inputElement","files","reader","FileReader","result","readAsDataURL","addEventListener","click"],"mappings":"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","file":"kaleidoscope.e31bb0bc.js","sourceRoot":"..","sourcesContent":["const rad = (deg) => (deg * Math.PI) / 180;\n\nconst random = (min, max) => Math.floor(Math.random() * (max - min) + min);\n\nconst RADIUS = 300;\nconst SLICE_ANGLE = 30;\n\nconst SLICE_OPPOSITE_ANGLE = (180 - SLICE_ANGLE) / 2;\nconst SLICE_HEIGHT = RADIUS / (2 * Math.sin(rad(SLICE_OPPOSITE_ANGLE)));\n\nconst patternCanvas = document.getElementById(\"pattern\");\nconst patternCtx = patternCanvas.getContext(\"2d\");\npatternCanvas.width = RADIUS;\npatternCanvas.height = SLICE_HEIGHT;\n\nconst invPatternCanvas = document.getElementById(\"invPattern\");\nconst invPatternCtx = invPatternCanvas.getContext(\"2d\");\ninvPatternCanvas.width = patternCanvas.width;\ninvPatternCanvas.height = patternCanvas.height;\n\nconst kCanvas = document.getElementById(\"kaleidoscope\");\nconst kCtx = kCanvas.getContext(\"2d\");\nkCanvas.width = RADIUS * 2;\nkCanvas.height = RADIUS * 2;\n\nconst drawWedge = (x, y, img) => {\n  patternCtx.save();\n\n  patternCtx.beginPath();\n  patternCtx.moveTo(0, SLICE_HEIGHT / 2);\n\n  const circlStart = rad(SLICE_ANGLE / -2) - 0.02;\n  const circleStop = rad(SLICE_ANGLE / 2) + 0.02;\n  patternCtx.arc(0, SLICE_HEIGHT / 2, RADIUS, circlStart, circleStop);\n\n  patternCtx.clip();\n  patternCtx.drawImage(\n    img,\n    x,\n    y,\n    RADIUS,\n    SLICE_HEIGHT,\n    0,\n    0,\n    RADIUS,\n    SLICE_HEIGHT\n  );\n\n  patternCtx.restore();\n};\n\n\nconst drawInverseWedge = () => {\n  invPatternCtx.save();\n  invPatternCtx.translate(0, SLICE_HEIGHT);\n  invPatternCtx.scale(1, -1);\n  invPatternCtx.drawImage(patternCanvas, 0, 0);\n  invPatternCtx.restore();\n};\n\n\nconst drawWheel = () => {\n  kCtx.save();\n  kCtx.translate(RADIUS, RADIUS);\n\n  for (let i = 0; i <= 360 / SLICE_ANGLE; i += 1) {\n    kCtx.rotate(rad(SLICE_ANGLE));\n    kCtx.drawImage(\n      i % 2 ? patternCanvas : invPatternCanvas,\n      0,\n      SLICE_HEIGHT / -2\n    );\n  }\n\n  kCtx.restore();\n};\n\nconst clearCanvases = () => {\n  patternCtx.clearRect(0, 0, patternCanvas.width, patternCanvas.height);\n  invPatternCtx.clearRect(\n    0,\n    0,\n    invPatternCanvas.width,\n    invPatternCanvas.height\n  );\n  kCtx.clearRect(0, 0, kCanvas.width, kCanvas.height);\n};\n\n\nconst selectPoint = (imgWidth, imgHeight) => {\n  const top = 0;\n  const left = 0;\n  const right = imgWidth - RADIUS;\n  const bottom = imgHeight - SLICE_HEIGHT;\n\n  return { x: random(left, right), y: random(top, bottom) };\n};\n\n\nconst kaleidoscopeGo = (img) => {\n  let point = selectPoint(img.width, img.height);\n  let x = img.width / 2;\n  let y = img.height / 2;\n\n  const loop = () => {\n    clearCanvases();\n    drawWedge(x, y, img);\n    drawInverseWedge();\n    drawWheel();\n\n    const distanceX = point.x - x;\n    const distanceY = point.y - y;\n\n    if (distanceX === 0 && distanceY === 0) {\n      point = selectPoint(img.width, img.height);\n    } else {\n      const length = Math.sqrt(distanceY * distanceY + distanceX * distanceX);\n      x = Math.round(x + distanceX / length);\n      y = Math.round(y + distanceY / length);\n    }\n\n    window.requestAnimationFrame(loop);\n  };\n\n  window.requestAnimationFrame(loop);\n};\n\n/* SELECTING A SUPPLIED IMAGE */\nconst selectImage = (e) => {\n  window.requestAnimationFrame(() => {\n    const img = new Image();\n    img.onload = () => kaleidoscopeGo(img);\n    img.src = e.target.src;\n  });\n};\n\nconst options = document.getElementsByClassName(\"optionImg\");\n\nfor (let i = 0; i < options.length; i++) {\n  options[i].onclick = selectImage;\n}\n\ndocument.getElementById(\"slowSpeed\").onclick = () => (speed = 0.5);\ndocument.getElementById(\"fastSpeed\").onclick = () => (speed = 1);\n\nconst handleFiles = () => {\n  runState = false;\n\n  const file = inputElement.files[0];\n  const reader = new FileReader();\n\n  reader.onload = (e) => {\n    const img = new Image();\n    img.onload = () => kaleidoscopeGo(img);\n    img.src = e.target.result;\n  };\n\n  reader.readAsDataURL(file);\n};\n\nconst inputElement = document.getElementById(\"upload\");\ninputElement.addEventListener(\"change\", handleFiles, false);\n\n/* SELECTING THE FIRST IMAGE BY DEFAULT */\noptions[0].click();\n"]}